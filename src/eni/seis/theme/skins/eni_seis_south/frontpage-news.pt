<metal:macro define-macro="portlet">
  <tal:def tal:define="
    news python: [b.getObject() for b in context.portal_catalog.searchResults(
        portal_type=['News Item'],
        review_state='published',
        sort_on='effective',
        sort_order='descending',
        path='/south/communication/newsletter')
        ][:9];
        toLocalizedTime nocall: context/@@plone/toLocalizedTime;
    ">

    <dl class="box leading-large portlet portletEvents" tal:condition="news">
      <dt>News</dt>
      <dd tal:define="firstn python: news[0]">
        <div>
          <a href="" tal:attributes="href firstn/absolute_url" class="tile">
            <img tal:attributes="src python:firstn.getLeadImagePath('mini', 'newsitem-fallback.png')" />
          </a>
          <a href="" tal:attributes="href firstn/absolute_url" class="tile" tal:content="firstn/Title">
            An event related to ENI-SEIS East
          </a>
          <div tal:content="firstn/Description">Description here</div>
        </div>

        <div tal:repeat="ni python:news[1:]">

          <a tal:attributes="href ni/absolute_url" class="tile" tal:content="ni/Title">
            news item
          </a>
          <span class="portletItemDetails location">
            Published: <tal:block tal:content="python:toLocalizedTime(ni.effective(),long_format=0)" />
          </span>

        </div>
      </dd>
    </dl>
  </tal:def>
</metal:macro>
